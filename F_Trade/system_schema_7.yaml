# Docker Compose: system_schema.yaml
# Auto-generated from TXT conversion
# Conversion date: 2025-06-20 10:52:44
# Type: Docker Compose YAML

version: '3.8'

# Metadata
x-metadata:
  conversion_date: "2025-06-20 10:52:44"
  source_file: "system_schema.yaml"
  auto_generated: true

services:
  app:
    image: "auto-generated:latest"
    container_name: "auto-generated-app"
    environment:
      - CONVERSION_DATE=2025-06-20 10:52:44
    
# Original content integrated below
  # Schema for system_config.yaml validation
  type: object
  required_fields:
    - system
    - database
    - trading
  properties:
    system:
      type: object
      required_fields:
        - name
        - version
        - environment
      properties:
        name:
          type: string
          length:
            min: 1
            max: 50
          description: "System name identifier"

        version:
          type: string
          pattern: '^\d+\.\d+\.\d+$'
          description: "Version in semantic versioning format (x.y.z)"

        environment:
          type: string
          enum: ["development", "testing", "staging", "production"]
          description: "Deployment environment"

        debug_mode:
          type: boolean
          description: "Enable debug mode"
          required: false

    database:
      type: object
      required_fields:
        - path
      properties:
        path:
          type: string
          pattern: '^[A-Za-z]:\\.*\.db$|^/.*\.db$'
          description: "Full path to SQLite database file"

        schema_path:
          type: string
          description: "Path to database schema file"
          required: false

        backup_enabled:
          type: boolean
          description: "Enable automatic database backups"
          required: false

        backup_interval_hours:
          type: integer
          min: 1
          max: 8760  # 1 year
          description: "Backup interval in hours"
          required: false

        max_connections:
          type: integer
          min: 1
          max: 100
          description: "Maximum database connections"
          required: false

        connection_timeout:
          type: integer
          min: 5
          max: 300
          description: "Database connection timeout in seconds"
          required: false

    trading:
      type: object
      required_fields:
        - enabled_pairs
      properties:
        enabled_pairs:
          type: array
          items:
            type: string
            pattern: '^[A-Z]{6}$|^XAU[A-Z]{3}$|^XAG[A-Z]{3}$'
          length:
            min: 1
            max: 50
          description: "List of enabled trading pairs"

        default_settings:
          type: object
          properties:
            lot_size:
              type: number
              min: 0.001
              max: 100.0
            max_spread:
              type: integer
              min: 0
              max: 100
            slippage:
              type: integer
              min: 0
              max: 50
            magic_number_base:
              type: integer
              min: 1000
              max: 999999
          required: false

        risk_management:
          type: object
          properties:
            max_daily_loss:
              type: number
              min: 0.0
              description: "Maximum daily loss limit"

            max_open_positions:
              type: integer
              min: 1
              max: 100
              description: "Maximum number of open positions"

            position_size_method:
              type: string
              enum: ["fixed", "percentage", "kelly", "volatility"]
              description: "Position sizing method"

            max_risk_per_trade:
              type: number
              min: 0.1
              max: 10.0
              description: "Maximum risk per trade as percentage"

            max_correlation_limit:
              type: number
              min: 0.0
              max: 1.0
              description: "Maximum correlation between open positions"
          required: false

    services:
      type: object
      properties:
        signal_generation:
          type: object
          properties:
            enabled:
              type: boolean

            interval_seconds:
              type: number
              min: 0.1
              max: 3600

            confidence_threshold:
              type: number
              min: 0.0
              max: 1.0

            max_signals_per_minute:
              type: integer
              min: 1
              max: 1000

            strategies:
              type: array
              items:
                type: string
                pattern: '^[A-Z_]+$'

            signal_timeout_seconds:
              type: integer
              min: 1
              max: 3600
          required: false

        market_data:
          type: object
          properties:
            enabled:
              type: boolean

            primary_source:
              type: string
              enum: ["mt4", "external_api", "mock"]

            backup_sources:
              type: array
              items:
                type: string
                enum: ["mt4", "external_api", "mock"]

            update_frequency:
              type: string
              enum: ["tick", "second", "minute"]

            buffer_size:
              type: integer
              min: 100
              max: 10000
          required: false

        analytics:
          type: object
          properties:
            enabled:
              type: boolean

            calculation_interval:
              type: integer
              min: 60
              max: 86400  # 24 hours

            metrics:
              type: array
              items:
                type: string
                enum: ["sharpe_ratio", "max_drawdown", "win_rate", "profit_factor", "calmar_ratio"]

            retention_days:
              type: integer
              min: 1
              max: 3650  # 10 years
          required: false

    monitoring:
      type: object
      properties:
        enabled:
          type: boolean

        health_check_interval:
          type: integer
          min: 10
          max: 3600
          description: "Health check interval in seconds"

        alert_thresholds:
          type: object
          properties:
            cpu_usage_percent:
              type: number
              min: 0
              max: 100

            memory_usage_percent:
              type: number
              min: 0
              max: 100

            disk_usage_percent:
              type: number
              min: 0
              max: 100

            error_rate_per_hour:
              type: integer
              min: 0
              max: 10000

            connection_failures_per_hour:
              type: integer
              min: 0
              max: 1000

        notification:
          type: object
          properties:
            enabled:
              type: boolean

            email_alerts:
              type: boolean

            webhook_url:
              type: string
              pattern: '^https?://.*'

            alert_cooldown_minutes:
              type: integer
              min: 1
              max: 1440  # 24 hours
          required: false
      required: false

    security:
      type: object
      properties:
        encryption_enabled:
          type: boolean

        api_rate_limiting:
          type: object
          properties:
            enabled:
              type: boolean
            requests_per_minute:
              type: integer
              min: 1
              max: 10000
          required: false

        access_control:
          type: object
          properties:
            ip_whitelist:
              type: array
              items:
                type: string
                pattern: '^(?:[0-9]{1,3}\.){3}[0-9]{1,3}$|^localhost$'

            require_authentication:
              type: boolean
          required: false
      required: false

  additional_properties: false

# Additional services can be defined here
# networks:
#   default:
#     driver: bridge
#
# volumes:
#   data:
#     driver: local
